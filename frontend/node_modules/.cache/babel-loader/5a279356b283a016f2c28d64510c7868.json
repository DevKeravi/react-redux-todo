{"ast":null,"code":"import { createAction, handleActions } from \"redux-actions\";\nimport { Map, List } from \"immutable\";\nimport * as postApi from \"../api/posts\";\nimport { call, put, all, takeEvery } from \"redux-saga/effects\";\nconst ADD = \"todo/ADD\";\nconst DEL = \"todo/DEL\";\nconst GET = \"todo/GET\";\nconst DONE = \"todo/DONE\";\nconst GET_POSTS_SUCCESS = \"todo/GET_POSTS_SUCCESS\";\nconst GET_POSTS_ERROR = \"todo/GET_POSTS_ERROR\";\nconst ADD_POST_SUCCESS = \"todo/ADD_POSTS_SUCCESS\";\nconst ADD_POST_ERROR = \"todo/ADD_POST_ERROR\";\nexport const add = createAction(ADD);\nexport const del = createAction(DEL);\nexport const get = createAction(GET);\nexport const done = createAction(DONE);\nconst initialState = List([Map({\n  text: \"\",\n  date: \"\",\n  id: null,\n  isdone: false\n})]);\n\nfunction* getPostsSaga() {\n  try {\n    const posts = yield call(postApi.getPosts);\n    yield put({\n      type: GET_POSTS_SUCCESS,\n      payload: posts\n    });\n  } catch (e) {\n    yield put({\n      type: GET_POSTS_ERROR,\n      error: true,\n      payload: e\n    });\n  }\n}\n\nfunction* addPostSaga() {\n  try {\n    const result = yield call(postApi.createPost);\n    yield put({\n      type: ADD_POST_SUCCESS,\n      payload: result\n    });\n  } catch (e) {\n    yield put({\n      type: ADD_POST_ERROR,\n      error: true,\n      payload: e\n    });\n  }\n}\n\nexport function* postsSaga() {\n  yield takeEvery(GET, getPostsSaga);\n  yield takeEvery(ADD, addPostSaga);\n}\nexport function* rootSaga() {\n  yield all([postsSaga()]);\n}\nexport default handleActions({\n  [ADD]: (state, action) => {\n    return state.push(Map(action.payload));\n  },\n  [DEL]: (state, action) => {\n    const index = state.findIndex(todo => todo.get(\"id\") === action.payload.id);\n    return state.delete(index);\n  },\n  [GET]: (state, action) => {\n    const index = state.findIndex(todo => todo.get(\"text\") === \"\");\n    return state.delete(index);\n  },\n  [DONE]: (state, action) => {\n    const index = state.findIndex(todo => todo.get(\"id\") === action.payload.id);\n    return state.setIn([index, \"isdone\"], !state.getIn([index, \"isdone\"]));\n  }\n}, initialState);","map":{"version":3,"sources":["/home/cmkrosp/go/src/react-redux-todo/frontend/src/modules/todo.js"],"names":["createAction","handleActions","Map","List","postApi","call","put","all","takeEvery","ADD","DEL","GET","DONE","GET_POSTS_SUCCESS","GET_POSTS_ERROR","ADD_POST_SUCCESS","ADD_POST_ERROR","add","del","get","done","initialState","text","date","id","isdone","getPostsSaga","posts","getPosts","type","payload","e","error","addPostSaga","result","createPost","postsSaga","rootSaga","state","action","push","index","findIndex","todo","delete","setIn","getIn"],"mappings":"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","sourcesContent":["import { createAction, handleActions } from \"redux-actions\";\nimport { Map, List } from \"immutable\";\nimport * as postApi from \"../api/posts\";\nimport { call, put, all, takeEvery } from \"redux-saga/effects\";\n\nconst ADD = \"todo/ADD\";\nconst DEL = \"todo/DEL\";\nconst GET = \"todo/GET\";\nconst DONE = \"todo/DONE\";\n\nconst GET_POSTS_SUCCESS = \"todo/GET_POSTS_SUCCESS\";\nconst GET_POSTS_ERROR = \"todo/GET_POSTS_ERROR\";\n\nconst ADD_POST_SUCCESS = \"todo/ADD_POSTS_SUCCESS\";\nconst ADD_POST_ERROR = \"todo/ADD_POST_ERROR\";\n\nexport const add = createAction(ADD);\nexport const del = createAction(DEL);\nexport const get = createAction(GET);\nexport const done = createAction(DONE);\n\nconst initialState = List([\n  Map({\n    text: \"\",\n    date: \"\",\n    id: null,\n    isdone: false,\n  }),\n]);\nfunction* getPostsSaga() {\n  try {\n    const posts = yield call(postApi.getPosts);\n    yield put({\n      type: GET_POSTS_SUCCESS,\n      payload: posts,\n    });\n  } catch (e) {\n    yield put({\n      type: GET_POSTS_ERROR,\n      error: true,\n      payload: e,\n    });\n  }\n}\n\nfunction* addPostSaga() {\n  try {\n    const result = yield call(postApi.createPost);\n    yield put({\n      type: ADD_POST_SUCCESS,\n      payload: result,\n    });\n  } catch (e) {\n    yield put({\n      type: ADD_POST_ERROR,\n      error: true,\n      payload: e,\n    });\n  }\n}\nexport function* postsSaga() {\n  yield takeEvery(GET, getPostsSaga);\n  yield takeEvery(ADD, addPostSaga);\n}\n\nexport function* rootSaga() {\n  yield all([postsSaga()]);\n}\n\nexport default handleActions(\n  {\n    [ADD]: (state, action) => {\n      return state.push(Map(action.payload));\n    },\n    [DEL]: (state, action) => {\n      const index = state.findIndex(\n        (todo) => todo.get(\"id\") === action.payload.id\n      );\n      return state.delete(index);\n    },\n    [GET]: (state, action) => {\n      const index = state.findIndex((todo) => todo.get(\"text\") === \"\");\n      return state.delete(index);\n    },\n    [DONE]: (state, action) => {\n      const index = state.findIndex(\n        (todo) => todo.get(\"id\") === action.payload.id\n      );\n      return state.setIn([index, \"isdone\"], !state.getIn([index, \"isdone\"]));\n    },\n  },\n  initialState\n);\n"]},"metadata":{},"sourceType":"module"}